package com.aricionur.model;

import com.mongodb.BasicDBObject;
import com.mongodb.DB;
import com.mongodb.DBCollection;
import com.mongodb.MongoClient;

import com.mongodb.DBCursor;

public class MongoDAO {

	MongoClient mongo;
	DB db;
	DBCollection table;

	public void MongoDAO() {
		/**** Connect to MongoDB ****/
		// Since 2.10.0, uses MongoClient
		this.mongo = new MongoClient("localhost", 27017);

		/**** Get database ****/
		// if database doesn't exists, MongoDB will create it for you
		this.db = mongo.getDB("testdb");

		/**** Get collection / table from 'testdb' ****/
		// if collection doesn't exists, MongoDB will create it for you
		this.table = db.getCollection("user");
	}

	public void insert(Person person) {
		/**** Insert ****/
		// create a document to store key and value
		BasicDBObject document = new BasicDBObject();
		document.put("id", person.getId());
		document.put("name", person.getName());
		document.put("age", person.getAge());

		table.insert(document);
	}

	public void displayMongodb(Person person) {

		DBCursor cursorDoc = table.find();
		while (cursorDoc.hasNext()) {
			System.out.println(cursorDoc.next());
		}

		System.out.println("Done");

		
//		/**** Find and display ****/
//		BasicDBObject searchQuery = new BasicDBObject();
//		searchQuery.put("name", "mkyong");
//
//		DBCursor cursor = table.find(searchQuery);
//
//		while (cursor.hasNext()) {
//			System.out.println(cursor.next());
//		}
	}

}
